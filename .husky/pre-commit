#!/bin/sh

echo "Running pre-commit checks..."

if git diff --cached --name-only | grep -q "src/untappd_parser/\(parser\|web\)\.py"; then
  echo "Rebuilding Python bundle..."
  npm run build
  git add src/untappd_parser_bundle.py
fi

echo "Running Biome..."
if ! npx @biomejs/biome check --write .; then
  echo "❌ Biome check failed. Please fix the errors above."
  exit 1
fi

echo "Running Stylelint..."
if ! npx stylelint "**/*.css" --fix; then
  echo "❌ Stylelint check failed. Please fix the errors above."
  exit 1
fi

echo "✅ All pre-commit checks passed!"
